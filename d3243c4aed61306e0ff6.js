(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{419:function(e,t,r){"use strict";r.d(t,"b",function(){return a}),r.d(t,"a",function(){return s});var i=r(99),a=function(e){var t=new FileReader;return new Promise(function(r,i){try{t.readAsDataURL(e),t.onloadend=function(){r(t.result)}}catch(e){throw new Error("Ошибка при чтении файла")}})},s=function(e){var t=i.a.defaults.baseURL;return"".concat(t,"/").concat(e)}},421:function(e,t,r){},429:function(e,t,r){"use strict";var i=r(421);r.n(i).a},440:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"addreviews"},[e.editReview?r("div",{staticClass:"addreviews__title"},[e._v("Редактировать отзыв")]):r("div",{staticClass:"addreviews__title"},[e._v("Новый отзыв")]),r("div",{staticClass:"addreviews__form"},[r("form",{staticClass:"reviews-form",on:{submit:function(t){e.editReview?e.editCurrentReview():e.addNewReview()}}},[r("div",{staticClass:"reviews-form__avatar"},[r("label",{staticClass:"upload-avatar",class:{error:e.validation.hasError("review.photo")}},[r("input",{attrs:{type:"file"},on:{change:e.handlePhotoUpload}}),r("div",{staticClass:"upload-avatar__img",class:{filled:e.renderedAvatar.length},style:{backgroundImage:e.userAvatarUrl}},[r("div",{staticClass:"upload-avatar__icon"})]),e.renderedAvatar.length?r("div",{staticClass:"upload-avatar__link"},[e._v("Редактировать фото")]):r("div",{staticClass:"upload-avatar__link"},[e._v("Добавить фото")]),r("div",{staticClass:"input-error"},[e._v(e._s(e.validation.firstError("review.photo")))])])]),r("div",{staticClass:"reviews-form__main"},[r("div",{staticClass:"box-field__row"},[r("div",{staticClass:"box-field",class:{error:e.validation.hasError("review.author")}},[r("label",{staticClass:"box-field__label"},[e._v("Имя автора")]),r("div",{staticClass:"box-field__input"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.review.author,expression:"review.author"}],staticClass:"form-control",attrs:{type:"text",value:"Ковальчук Дмитрий"},domProps:{value:e.review.author},on:{input:function(t){t.target.composing||e.$set(e.review,"author",t.target.value)}}}),r("div",{staticClass:"input-error"},[e._v(e._s(e.validation.firstError("review.author")))])])]),r("div",{staticClass:"box-field",class:{error:e.validation.hasError("review.occ")}},[r("label",{staticClass:"box-field__label"},[e._v("Титул автора")]),r("div",{staticClass:"box-field__input"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.review.occ,expression:"review.occ"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.review.occ},on:{input:function(t){t.target.composing||e.$set(e.review,"occ",t.target.value)}}}),r("div",{staticClass:"input-error"},[e._v(e._s(e.validation.firstError("review.occ")))])])])]),r("div",{staticClass:"box-field",class:{error:e.validation.hasError("review.text")}},[r("label",{staticClass:"box-field__label"},[e._v("Отзыв")]),r("div",{staticClass:"box-field__input"},[r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.review.text,expression:"review.text"}],staticClass:"form-control",domProps:{value:e.review.text},on:{input:function(t){t.target.composing||e.$set(e.review,"text",t.target.value)}}}),r("div",{staticClass:"input-error"},[e._v(e._s(e.validation.firstError("review.text")))])])]),r("div",{staticClass:"box-field-btn"},[r("a",{staticClass:"cancel-form",attrs:{type:"#"},on:{click:function(t){return t.preventDefault(),e.closeForm(t)}}},[e._v("Отмена")]),r("input",{staticClass:"btn btn-orange",attrs:{type:"submit",value:"Сохранить"}})])])])])])};i._withStripped=!0;var a=r(27),s=r(97),n=r(419);r(99);function o(e,t,r,i,a,s,n){try{var o=e[s](n),c=o.value}catch(e){return void r(e)}o.done?t(c):Promise.resolve(c).then(i,a)}function c(e){return function(){var t=this,r=arguments;return new Promise(function(i,a){var s=e.apply(t,r);function n(e){o(s,i,a,n,c,"next",e)}function c(e){o(s,i,a,n,c,"throw",e)}n(void 0)})}}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},i=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),i.forEach(function(t){l(e,t,r[t])})}return e}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var v={mixins:[r(97).mixin],validators:{"review.author":function(e){return s.Validator.value(e).required("Заполните автора")},"review.occ":function(e){return s.Validator.value(e).required("Укажите роль автора")},"review.text":function(e){return s.Validator.value(e).required("Введите текст отзыва")},"review.photo":function(e){return s.Validator.value(e).required("Вставте аватар")}},props:{cancel:Function},data:function(){return{renderedAvatar:"",review:{id:0,author:"",occ:"",text:"",photo:""}}},watch:{currentReview:function(e){!0===this.editReview&&this.fillFormWithCurrentReviewData()}},created:function(){!0===this.editReview&&this.fillFormWithCurrentReviewData()},computed:u({userAvatarUrl:function(){return"url(".concat(this.renderedAvatar,")")}},Object(a.d)("reviews",{currentReview:function(e){return e.currentReview}}),Object(a.d)("reviews",{editReview:function(e){return e.edit}})),methods:u({},Object(a.b)("reviews",["addReview","updateReview"]),Object(a.b)("tooltips",["showTooltip"]),Object(a.c)("reviews",["setEdit"]),{closeForm:function(){this.review.author="",this.review.occ="",this.review.author="",this.review.text="",this.review.photo="",this.disabledRorm=!0,this.setEdit(!1),this.cancel()},editCurrentReview:function(){var e=c(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("editCurrentReview"),e.next=3,this.$validate();case 3:if(e.t0=e.sent,!1!==e.t0){e.next=6;break}return e.abrupt("return");case 6:return this.disabledRorm=!0,this.setEdit(!1),e.prev=8,e.next=11,this.updateReview(this.review);case 11:e.sent,this.clearFormFields(),this.showTooltip({type:"success",text:"Отзыв обновлен"}),e.next=19;break;case 16:e.prev=16,e.t1=e.catch(8),this.showTooltip({type:"error",text:e.t1.message});case 19:return e.prev=19,this.disabledRorm=!1,this.validation.reset(),e.finish(19);case 23:case"end":return e.stop()}},e,this,[[8,16,19,23]])}));return function(){return e.apply(this,arguments)}}(),addNewReview:function(){var e=c(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("addNewReview"),e.next=3,this.$validate();case 3:if(e.t0=e.sent,!1!==e.t0){e.next=6;break}return e.abrupt("return");case 6:return this.disabledRorm=!0,e.prev=7,e.next=10,this.addReview(this.review);case 10:e.sent,this.clearFormFields(),e.next=17;break;case 14:e.prev=14,e.t1=e.catch(7),this.showTooltip({type:"error",text:e.t1.message});case 17:return e.prev=17,this.disabledRorm=!1,this.validation.reset(),e.finish(17);case 21:case"end":return e.stop()}},e,this,[[7,14,17,21]])}));return function(){return e.apply(this,arguments)}}(),clearFormFields:function(){this.review.author="",this.review.occ="",this.review.author="",this.review.text="",this.review.photo="",this.renderedAvatar=""},fillFormWithCurrentReviewData:function(){this.review=u({},this.currentReview),this.rendedPhotoUrl=Object(n.a)(this.currentReview.photo)},handlePhotoUpload:function(){var e=c(regeneratorRuntime.mark(function e(t){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.target.files[0],this.review.photo=r,e.prev=2,e.next=5,Object(n.b)(r);case 5:i=e.sent,this.renderedAvatar=i,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),this.showTooltip({type:"error",text:"Ошибка во время обработки файла"});case 12:case"end":return e.stop()}},e,this,[[2,9]])}));return function(t){return e.apply(this,arguments)}}()})},d=(r(429),r(42)),h=Object(d.a)(v,i,[],!1,null,null,null);h.options.__file="src/admin/components/addreviews.vue";t.default=h.exports}}]);