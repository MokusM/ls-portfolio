(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{419:function(t,r,e){"use strict";e.d(r,"b",function(){return o}),e.d(r,"a",function(){return s});var i=e(99),o=function(t){var r=new FileReader;return new Promise(function(e,i){try{r.readAsDataURL(t),r.onloadend=function(){e(r.result)}}catch(t){throw new Error("Ошибка при чтении файла")}})},s=function(t){var r=i.a.defaults.baseURL;return"".concat(r,"/").concat(t)}},420:function(t,r,e){},428:function(t,r,e){"use strict";var i=e(420);e.n(i).a},438:function(t,r,e){"use strict";e.r(r);var i=function(){var t=this,r=t.$createElement,e=t._self._c||r;return e("div",{staticClass:"addreviews"},[t.editWork?e("div",{staticClass:"addreviews__title"},[t._v("Редактирование работы")]):e("div",{staticClass:"addreviews__title"},[t._v("Новая работа")]),e("div",{staticClass:"addreviews__form"},[e("form",{staticClass:"reviews-form works-form",on:{submit:function(r){t.editWork?t.editCurrentWork():t.addNewWork()}}},[e("div",{staticClass:"works-form__file"},[t.editWork?e("div",{staticClass:"works-form__pic"},[e("div",{staticClass:"works-form__img",style:{backgroundImage:t.workImgUrl,filled:t.renderedImg.length}},[t.renderedImg.length?t._e():e("img",{staticClass:"author-avatar",attrs:{src:"https://webdev-api.loftschool.com/"+t.work.photo,alt:""}})]),t.editWork?e("div",{staticClass:"upload-avatar__link"},[t._v("Редактировать фото"),e("input",{staticClass:"works-form__change",attrs:{type:"file"},on:{change:t.handlePhotoUpload}})]):t._e()]):e("div",{staticClass:"upload-file-wrap"},[e("div",{staticClass:"upload-file",class:{error:t.validation.hasError("work.photo"),filled:t.renderedImg.length},style:{backgroundImage:t.workImgUrl}},[t.renderedImg.length?t._e():e("div",{staticClass:"upload-file__title"},[t._v("Перетащите или загрузите для загрузки изображения            ")]),t.renderedImg.length?t._e():e("span",{staticClass:"btn btn-orange"},[t._v("ЗАГРУЗИТЬ  ")]),e("input",{staticClass:"works-form__change",attrs:{type:"file"},on:{change:t.handlePhotoUpload}}),e("div",{staticClass:"input-error"},[t._v(t._s(t.validation.firstError("work.photo")))])])])]),e("div",{staticClass:"reviews-form__main"},[e("div",{staticClass:"box-field",class:{error:t.validation.hasError("work.work")}},[e("label",{staticClass:"box-field__label"},[t._v("Название")]),e("div",{staticClass:"box-field__input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.work.title,expression:"work.title"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.work.title},on:{input:function(r){r.target.composing||t.$set(t.work,"title",r.target.value)}}}),e("div",{staticClass:"input-error"},[t._v(t._s(t.validation.firstError("work.title")))])])]),e("div",{staticClass:"box-field",class:{error:t.validation.hasError("work.link")}},[e("label",{staticClass:"box-field__label"},[t._v("Ссылка")]),e("div",{staticClass:"box-field__input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.work.link,expression:"work.link"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.work.link},on:{input:function(r){r.target.composing||t.$set(t.work,"link",r.target.value)}}}),e("div",{staticClass:"input-error"},[t._v(t._s(t.validation.firstError("work.link")))])])]),e("div",{staticClass:"box-field",class:{error:t.validation.hasError("work.description")}},[e("label",{staticClass:"box-field__label"},[t._v("Описание")]),e("div",{staticClass:"box-field__input"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.work.description,expression:"work.description"}],staticClass:"form-control",domProps:{value:t.work.description},on:{input:function(r){r.target.composing||t.$set(t.work,"description",r.target.value)}}}),e("div",{staticClass:"input-error"},[t._v(t._s(t.validation.firstError("work.description")))])])]),e("div",{staticClass:"box-field box-field_mb20",class:{error:t.validation.hasError("work.techs")}},[e("label",{staticClass:"box-field__label"},[t._v("Добавление тэга")]),e("div",{staticClass:"box-field__input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.work.techs,expression:"work.techs"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.work.techs},on:{input:function(r){r.target.composing||t.$set(t.work,"techs",r.target.value)}}}),e("div",{staticClass:"input-error"},[t._v("{{ validation.firstError('work.techs') }")])])]),e("ul",{staticClass:"tag-list tag-list-with-remove"},t._l(t.tagsArray,function(r,i){return e("li",{staticClass:"tag-list__item"},[r.length?e("div",{staticClass:"tag-list__title"},[t._v(t._s(r)),e("a",{staticClass:"tag-list__remote",attrs:{href:"#"},on:{click:function(r){return r.preventDefault(),t.removeTag(i)}}})]):t._e()])}),0),e("div",{staticClass:"box-field-btn"},[e("a",{staticClass:"cancel-form",attrs:{type:"#"},on:{click:function(r){return r.preventDefault(),t.closeForm(r)}}},[t._v("Отмена")]),e("input",{staticClass:"btn btn-orange",attrs:{type:"submit",value:"Сохранить"}})])])])])])};i._withStripped=!0;var o=e(27),s=e(97),a=e(419);e(99);function n(t,r,e,i,o,s,a){try{var n=t[s](a),l=n.value}catch(t){return void e(t)}n.done?r(l):Promise.resolve(l).then(i,o)}function l(t){return function(){var r=this,e=arguments;return new Promise(function(i,o){var s=t.apply(r,e);function a(t){n(s,i,o,a,l,"next",t)}function l(t){n(s,i,o,a,l,"throw",t)}a(void 0)})}}function c(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{},i=Object.keys(e);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(e).filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.forEach(function(r){u(t,r,e[r])})}return t}function u(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}var d={mixins:[e(97).mixin],validators:{"work.title":function(t){return s.Validator.value(t).required("Введите название роботы")},"work.link":function(t){return s.Validator.value(t).required("Введите ссылку на работу")},"work.description":function(t){return s.Validator.value(t).required("Введите описание работы")},"work.techs":function(t){return s.Validator.value(t).required("Вставте основные тегы")},"work.photo":function(t){return s.Validator.value(t).required("Вставте превью фото")}},props:{cancel:Function},data:function(){return{renderedImg:"",work:{id:0,title:"",link:"",description:"",techs:"",photo:""}}},watch:{currentWork:function(t){!0===this.editWork&&this.fillFormWithCurrentWorkData()}},created:function(){!0===this.editWork&&this.fillFormWithCurrentWorkData()},computed:c({workImgUrl:function(){return"url(".concat(this.renderedImg,")")}},Object(o.d)("works",{currentWork:function(t){return t.currentWork}}),Object(o.d)("works",{editWork:function(t){return t.edit}}),{tagsArray:function(){return this.work.techs.split(",")}}),methods:c({},Object(o.b)("works",["addWork","updateWork"]),Object(o.b)("tooltips",["showTooltip"]),Object(o.c)("works",["setEdit"]),{closeForm:function(){this.work.title="",this.work.link="",this.work.description="",this.work.text="",this.work.techs="",this.work.photo="",this.disabledRorm=!0,this.setEdit(!1),this.cancel()},editCurrentWork:function(){var t=l(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$validate();case 2:if(t.t0=t.sent,!1!==t.t0){t.next=5;break}return t.abrupt("return");case 5:return this.disabledRorm=!0,this.setEdit(!1),t.prev=7,t.next=10,this.updateWork(this.work);case 10:t.sent,this.clearFormFields(),this.showTooltip({type:"success",text:"Отзыв обновлен"}),t.next=18;break;case 15:t.prev=15,t.t1=t.catch(7),this.showTooltip({type:"error",text:t.t1.message});case 18:return t.prev=18,this.disabledRorm=!1,this.validation.reset(),t.finish(18);case 22:case"end":return t.stop()}},t,this,[[7,15,18,22]])}));return function(){return t.apply(this,arguments)}}(),addNewWork:function(){var t=l(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$validate();case 2:if(t.t0=t.sent,!1!==t.t0){t.next=5;break}return t.abrupt("return");case 5:return this.disabledRorm=!0,t.prev=6,t.next=9,this.addWork(this.work);case 9:t.sent,this.clearFormFields(),t.next=16;break;case 13:t.prev=13,t.t1=t.catch(6),this.showTooltip({type:"error",text:t.t1.message});case 16:return t.prev=16,this.disabledRorm=!1,this.validation.reset(),t.finish(16);case 20:case"end":return t.stop()}},t,this,[[6,13,16,20]])}));return function(){return t.apply(this,arguments)}}(),clearFormFields:function(){this.work.title="",this.work.link="",this.work.description="",this.work.text="",this.work.techs="",this.work.photo="",this.renderedImg=""},fillFormWithCurrentWorkData:function(){this.work=c({},this.currentWork),this.rendedImgUrl=Object(a.a)(this.currentWork.photo)},handlePhotoUpload:function(){var t=l(regeneratorRuntime.mark(function t(r){var e,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.target.files[0],this.work.photo=e,t.prev=2,t.next=5,Object(a.b)(e);case 5:i=t.sent,this.renderedImg=i,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),this.showTooltip({type:"error",text:"Ошибка во время обработки файла"});case 12:case"end":return t.stop()}},t,this,[[2,9]])}));return function(r){return t.apply(this,arguments)}}(),removeTag:function(t){this.tagsArray.splice(t,1)}})},v=(e(428),e(42)),p=Object(v.a)(d,i,[],!1,null,null,null);p.options.__file="src/admin/components/addworks.vue";r.default=p.exports}}]);